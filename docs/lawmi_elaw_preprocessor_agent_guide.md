# LAWmi 전자소송 전처리 에이전트 가이드

## 개요
LAWmi 전자소송 전처리 에이전트는 법원 전자소송 시스템에서 다운로드한 PDF 파일들을 LAWmi v6.0 표준에 맞게 자동으로 정리하고 분류하는 에이전트입니다.

## 주요 기능

### 1. 자동 파일 분류
- **7_제출증거**: 갑/을 증거 파일
- **8_제출서면**: 소장, 답변서, 준비서면 등 제출 서면
- **9_판결등**: 판결문, 결정문 등
- **절차관련**: 위임장, 송달증명원 등 절차 서류

### 2. 파일명 표준화
- 날짜 형식: YYYY.MM.DD.자
- 증거 형식: (갑1), (을2-1)
- 당사자 표시: _원고, _피고

### 3. 평가 및 개선 기능 (신규)
- **애매한 분류 검토**: 1_기본정보로 분류된 애매한 파일 재검토
- **재분류 제안**: 절차관련 폴더의 파일 중 제출증거/서면으로 보이는 파일 재검토
- **패턴 학습**: 사용자 피드백을 통한 분류 규칙 개선
- **자동 업데이트**: 학습된 패턴을 config.yaml에 반영

## 실행 방법

### 기본 실행
```bash
python run_lawpass_casefiles_management_system_step4.py
```

### 직접 실행
```bash
# 전처리만 실행
python steps/step4_casefiles_renamer.py <사건폴더경로>

# 평가 및 개선만 실행
python steps/step4_postprocess_review.py <사건폴더경로>
```

## 평가 및 개선 프로세스

### 1단계: 애매한 파일 검토
- 1_기본정보로 분류된 파일 중 다음 패턴 검사:
  - 증거로 보이는 패턴: 입증자료, 증명서, 확인서, 거래내역 등
  - 제출서면으로 보이는 패턴: 보정서, 신고서, 통지서 등

### 2단계: 절차관련 폴더 재검토
- 절차관련 폴더의 파일 중 다음 항목 확인:
  - 갑/을 증거 파일
  - 답변서, 준비서면 등 제출서면
  - 판결문, 결정문 등

### 3단계: 사용자 확인
- 각 파일에 대해 재분류 여부 확인
- 새로운 카테고리 지정 가능

### 4단계: 개선사항 적용
- file_classification_improvements.json에 저장
- 패턴 학습 및 config.yaml 업데이트

## 설정 파일 구조

### config.yaml
```yaml
file_naming_rules:
  prefix_patterns:
    "7_제출증거_":
      - "갑\\d+"
      - "을\\d+"
      - "사실조회.*회신"
      - "증인신문조서"
    "8_제출서면_":
      - "소장"
      - "답변서"
      - "준비서면"
      - "의견서"
      - "신청서"
    "9_판결등_":
      - "판결문"
      - "결정문"
      - "지급명령결정문"
```

### file_classification_improvements.json
```json
{
  "improvements": [
    {
      "type": "reclassify",
      "filename": "파일명",
      "from": "1_기본정보",
      "to": "7_제출증거",
      "reason": "증거자료로 보임",
      "timestamp": "2024-01-20T10:00:00"
    }
  ],
  "patterns": {
    "거래내역": {
      "7_제출증거": 3,
      "1_기본정보": 1
    }
  }
}
```

## 주의사항

1. **백업 권장**: 원본 파일은 보존되지만 작업 전 백업 권장
2. **권한 확인**: 파일 읽기/쓰기 권한 필요
3. **경로 확인**: Windows/Linux 경로 자동 변환 지원

## 개선 제안 활용

평가 작업에서 수집된 개선사항은 다음과 같이 활용됩니다:

1. **즉시 적용**: 현재 사건의 파일 재분류
2. **패턴 학습**: 향후 유사 파일 자동 분류
3. **규칙 업데이트**: config.yaml에 새로운 패턴 추가

## 문제 해결

### 파일 분류가 잘못된 경우
1. 평가 작업 실행 (자동으로 제안됨)
2. 재분류 확인 및 승인
3. 패턴이 자동으로 학습됨

### 새로운 문서 유형 추가
1. config.yaml의 prefix_patterns에 패턴 추가
2. 또는 평가 작업을 통해 자동 학습

## 버전 정보
- 현재 버전: v2.0
- 주요 변경사항:
  - v2.0: 평가 및 개선 기능 추가
  - v1.0: 기본 전처리 기능